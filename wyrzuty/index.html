<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <title>Wyrzuty s≈Çoneczne | AstroTrapez</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="stylesheet" href="../css/styles.css?v=8" />
  <style>
    body{background:radial-gradient(1400px 800px at 70% 25%, #2a2358 0%, transparent 60%), #060712; color:#e8ecff; font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif}
    .container{max-width:1100px;margin:0 auto;padding:16px}
    .brand{display:flex;align-items:center;gap:12px;margin:8px 0 12px}
    .home-link{display:flex;align-items:center;gap:10px;color:inherit;text-decoration:none}
    .home-link:hover{opacity:.95}
    .brand h1{font-size:28px;font-weight:900}
    .brand svg{width:28px;height:28px;filter:drop-shadow(0 4px 8px rgba(0,0,0,.35))}
    .btn{border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.06);color:#e8ecff;padding:6px 12px;border-radius:999px;cursor:pointer;font-weight:800}
    .btn:hover{opacity:.85}

    .section{background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.08);border-radius:16px;box-shadow:0 12px 30px rgba(0,0,0,.45);padding:16px}
    .grid{display:grid;gap:16px}
    .grid-2{grid-template-columns:1fr 1fr}
    @media(max-width:900px){.grid-2{grid-template-columns:1fr}}
    .flare-box{background:rgba(0,0,0,.35);border:1px solid rgba(255,255,255,.08);border-radius:12px;box-shadow:0 8px 18px rgba(0,0,0,.45);padding:12px;margin-bottom:10px}
    #flareList{max-height:600px;overflow-y:auto;padding-right:6px}
    #flareList::-webkit-scrollbar{width:8px}
    #flareList::-webkit-scrollbar-thumb{background:#7aa2ff;border-radius:10px}
    img{width:100%;border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,.45)}
  </style>
</head>
<body>
  <div class="container">
    <div class="brand">
      <a href="/" class="home-link" aria-label="Strona g≈Ç√≥wna AstroTrapez">
        <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M4 20h16M12 20v-6m7.5-6.5-7 3.5-3-6 7-3.5 3 6Z" stroke="#bcd1ff" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M6 16l3-2" stroke="#bcd1ff" stroke-width="1.6" stroke-linecap="round"/>
        </svg>
        <h1>AstroTrapez ‚Äî Wyrzuty</h1>
      </a>
      <button id="goBack" class="btn" style="margin-left:auto">‚Üê Wr√≥ƒá</button>
    </div>

    <div class="section">
      <h2 style="margin:0 0 10px;font-size:22px">‚òÄÔ∏è Wyrzuty s≈Çoneczne</h2>
      <div class="grid grid-2" style="margin-top:10px">
        <!-- LEWA: sondy -->
        <div>
          <div class="flare-box">
            <h3 style="margin:0 0 6px">NASA SDO (304 √Ö)</h3>
            <img src="https://sdo.gsfc.nasa.gov/assets/img/latest/latest_1024_0304.jpg" alt="SDO 304 √Ö">
          </div>
          <div class="flare-box">
            <h3 style="margin:0 0 6px">SOHO LASCO C2 (korona)</h3>
            <img src="https://sohowww.nascom.nasa.gov/data/realtime/c2/1024/latest.jpg" alt="SOHO LASCO C2">
          </div>
        </div>

        <!-- PRAWA: DONKI -->
        <div>
          <h3 style="margin:0 0 8px">üîé Dane NASA DONKI (14 dni)</h3>
          <div id="flareList">Wczytywanie...</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Wr√≥ƒá lub na /
    (function(){
      const back = document.getElementById('goBack');
      if(back){
        back.addEventListener('click', ()=>{
          const sameOriginRef = document.referrer && new URL(document.referrer).origin === location.origin;
          if (sameOriginRef && history.length > 1) history.back(); else location.href = '/';
        });
      }
    })();

    // DONKI
    async function loadFlares(){
      const end=new Date(); const start=new Date(end.getTime()-1000*60*60*24*14);
      const url=`https://api.nasa.gov/DONKI/FLR?startDate=${start.toISOString().slice(0,10)}&endDate=${end.toISOString().slice(0,10)}&api_key=DEMO_KEY`;
      try{
        const r=await fetch(url); const data=await r.json();
        const list=document.getElementById('flareList'); list.innerHTML='';
        if(Array.isArray(data) && data.length){
          data.sort((a,b)=>new Date(b.beginTime)-new Date(a.beginTime));
          for(const flr of data){
            const el=document.createElement('div'); el.className='flare-box';
            el.innerHTML = `<strong>${flr.classType||'N/A'}</strong> ‚Ä¢ ${new Date(flr.beginTime).toLocaleString()}<br>
              ${flr.sourceLocation||''} ${flr.activeRegionNum?('‚Ä¢ AR '+flr.activeRegionNum):''}
              ${flr.peakTime?('<br><span style="color:#aab2d5">peak:</span> '+new Date(flr.peakTime).toLocaleString()):''}`;
            list.appendChild(el);
          }
        } else {
          list.textContent = 'Brak danych w tym zakresie.';
        }
      }catch(e){
        document.getElementById('flareList').textContent = 'B≈ÇƒÖd pobierania danych NASA.';
      }
    }
    loadFlares();
  </script>
</body>
</html>
